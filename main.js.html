<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>main.js - Documentation</title>

    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="https://code.ionicframework.com/ionicons/2.0.1/css/ionicons.min.css">
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>
<body>

<input type="checkbox" id="nav-trigger" class="nav-trigger" />
<label for="nav-trigger" class="navicon-button x">
  <div class="navicon"></div>
</label>

<label for="nav-trigger" class="overlay"></label>

<nav>
    <li class="nav-link nav-home-link"><a href="index.html">Home</a></li><li class="nav-heading">Classes</li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="RecipeCard.html">RecipeCard</a></span></li><li class="nav-heading"><a href="global.html">Globals</a></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#addFavoriteRecipe">addFavoriteRecipe</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#bindRC">bindRC</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#createRecipeCards">createRecipeCards</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#createRecipeObject">createRecipeObject</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#evaluateFraction">evaluateFraction</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#extractIngredients">extractIngredients</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#extractNutrition">extractNutrition</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#extractSteps">extractSteps</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#fetchRecipes">fetchRecipes</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#generateUniqueID">generateUniqueID</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#getDeletedRecipes">getDeletedRecipes</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#getFavoriteRecipes">getFavoriteRecipes</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#getLocalStorageRecipes">getLocalStorageRecipes</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#getNRandomRecipes">getNRandomRecipes</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#getRandomNumbers">getRandomNumbers</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#getRecipesByType">getRecipesByType</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#getRecipesCount">getRecipesCount</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#ingredientUpdates">ingredientUpdates</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#init">init</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#loadUserData">loadUserData</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#nutritionUpdates">nutritionUpdates</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#populateListElements">populateListElements</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#populateLists">populateLists</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#populateRecipes">populateRecipes</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#removeDeletedRecipes">removeDeletedRecipes</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#removeFavoriteRecipe">removeFavoriteRecipe</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#removeRecipe">removeRecipe</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#removeSummaryLinks">removeSummaryLinks</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#searchLocalRecipes">searchLocalRecipes</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#setIntolerances">setIntolerances</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#setLocalStorageItem">setLocalStorageItem</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#setMaxTime">setMaxTime</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#setUpBtns">setUpBtns</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#setUpRefreshButton">setUpRefreshButton</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#updateLatestSearch">updateLatestSearch</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#updateUserData">updateUserData</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#webScrapper">webScrapper</a></span></li>
</nav>

<div id="main">
    
    <h1 class="page-title">main.js</h1>
    

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/**
 * Homepage JS file
 */

import * as util from './API/utilityFunctions.js'
import * as LSHandler from './API/localStorageHandler.js'

window.addEventListener('DOMContentLoaded', init)

document.getElementById('create-recipe').addEventListener('click', e => {
  document.getElementById('create-recipe').classList.toggle('rotate-btn')
  const manualBtn = document.getElementById('manual-btn')
  const scrapperBtn = document.getElementById('webscrapper-btn')
  manualBtn.classList.toggle('manual-show')
  manualBtn.classList.toggle('manual-hide')
  scrapperBtn.classList.toggle('scrapper-show')
  scrapperBtn.classList.toggle('scrapper-hide')
})

document.getElementById('manual-btn').addEventListener('click', e => {
  window.location.href = '/createRecipe.html'
})

document.getElementById('webscrapper-btn').addEventListener('click', async (e) => {
  const url = prompt('Link To Any Recipe You Found On Search Engines:')
  if (url != null) {
    const noSpace = url.split(' ').join('')
    const id = await util.webScrapper(noSpace)
    window.location.href = '/recipePage.html#' + id
  }
})

document.getElementById('update-preference').addEventListener('click', (e) => {
  localStorage.clear()
  window.location.reload()
})

/**
 * Function that runs when the page loads
 */
function init () {
  getUserPrefs()

  // display the 5 recipes and add search btn listener only in homepage
  if (window.location.pathname === '/index.html' || window.location.pathname === '/' || window.location.pathname === '') {
    setUpRefreshButton()
    util.populateRecipes().then(() => {
      setTimeout(() => {
        createRecipeCards(util.NUMBER_OF_RECIPES_TO_DISPLAY, 'explore-recipes')
        createRecipeCards(util.NUMBER_OF_RECIPES_TO_DISPLAY, 'main-recipes', 'main dish')
        createRecipeCards(util.NUMBER_OF_RECIPES_TO_DISPLAY, 'side-recipes', 'side dish')
        createRecipeCards(util.NUMBER_OF_RECIPES_TO_DISPLAY, 'salad-recipes', 'salad')
      }, 500)
    })
    const searchBtn = document.getElementById('search')
    searchBtn.addEventListener('click', e => {
      e.preventDefault()
      const searchQuery = document.getElementById('search-query').value
      LSHandler.searchLocalRecipes(searchQuery).then(() => {
        window.location.href = '/searchpage.html'
      })
    })
  } else {
    util.populateRecipes()
  }
}

/**
 * Create recipe cards for an arbitrary amount of recipes
 *
 * @param {number} N The number of recipes to display
 * @param {string} id The id of the section to display
 * @param {string} type The type of recipes to display (main dish, side dish, salad, soup)
* @param {boolean} search If you're creating recipe cards from a search query
 *
 */
export function createRecipeCards (N, id, type = null) {
  let recipes
  let loaderId = 'explore'
  if (!type) {
    recipes = LSHandler.getNRandomRecipes(N)
  } else {
    recipes = LSHandler.getRecipesByType(N, type)
    loaderId = type.split(' ')[0]
  }

  const loader = document.getElementById(loaderId + '-loader')
  if (loader) { loader.remove() }

  // Get the recipe cards' section element
  const recipeCardsSection = document.getElementById(id)

  recipes.forEach(recipe => {
    const recipeCard = document.createElement('recipe-card')
    recipeCard.data = recipe
    const key = recipe.id
    bindRC(recipeCard, key)
    recipeCardsSection.appendChild(recipeCard)
  })
}

/**
 * Binds a recipe card to its router page function via the 'click' event
 *
 * @param {HTMLElement} recipeCard The element to which we bind an event listener
 * @param {string} key The id of the recipe card
 */
function bindRC (recipeCard, key) {
  recipeCard.addEventListener('click', e => {
    window.location.href = '/recipePage.html#' + key
  })
}

function getUserPrefs () {
  if (LSHandler.getLocalStorageRecipes().length === 0) {
    LSHandler.updateUserData('offset', util.DEFAULT_OFFSET)
    const intols = prompt('Enter your intolerances (ingredients not to include)\n\nAvailable: dairy, gluten, shellfish, seafood, wheat, eggs, peanut, soy, grain, sesame, tree nut, sulfite')
    LSHandler.setIntolerances(intols)

    const maxTime = prompt("Enter the maximum amount of time you'd want to spend making a recipe (in minutes)")
    LSHandler.setMaxTime(maxTime)
  }
}

/**
 * sets up the refresh button for the explore cointaner on homepage
 */
function setUpRefreshButton () {
  document.getElementById('refresh-btn').addEventListener('click', event => {
    const exploreContainer = document.getElementById('explore-recipes')
    while (exploreContainer.firstChild) {
      exploreContainer.removeChild(exploreContainer.firstChild)
    }
    createRecipeCards(util.NUMBER_OF_RECIPES_TO_DISPLAY, 'explore-recipes')
  })
}
</code></pre>
        </article>
    </section>




</div>

<br class="clear">

<footer>
    Generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.6.7</a> on Sun Dec 12 2021 23:00:45 GMT+0000 (Coordinated Universal Time) using the Minami theme.
</footer>

<script>prettyPrint();</script>
<script src="scripts/linenumber.js"></script>
</body>
</html>
